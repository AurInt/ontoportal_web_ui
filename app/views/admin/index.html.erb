<script type="text/javascript">
    function resetMemcacheConnection(){
        ajaxCall("resetcache", "#reset_memcache_status");
    }
    
    function flushMemcache(){
        ajaxCall("clearcache", "#flush_memcache_status");
    }
    
    function ajaxCall(operation, status){
        $(status).html("");
        $.ajax({
            type: "GET",
            url: "/admin?" + operation + "=true",
            data: "",
            dataType: "text",
            beforeSend: function(XMLHttpRequest){
                updateStatus(XMLHttpRequest, status)
            },
            success: function(data, msg){
                $(status).text(data).html();
            },
            error: function(XMLHttpRequest, textStatus, errorThrown){
                $(status).html(errorThrown + " " + textStatus);
            }
        });
    };
    
    function updateStatus(XMLHttpRequest, status){
        $(status).html("Loading");
    }
</script>
<style>
    .admin_utilities td {
        padding: .5em;
    }
</style>
<div class="feedback" style="width: 80%; padding: 2em;">
    <%= render :partial => 'memcache_stats' %>
    <div>
        <h2>Memcache Utilities</h2>
        <table class="admin_utilities" style="float: left;">
            <tr>
                <td>
                    <input type="button" onclick="flushMemcache();" value="Flush Memcache">
                </td>
                <td>
                    <span id="flush_memcache_status"></span>
                </td>
            </tr>
            <tr>
                <td>
                    <input type="button" onclick="resetMemcacheConnection();" value="Reset Memcache Connection">
                </td>
                <td>
                    <span id="reset_memcache_status"></span>
                </td>
            </tr>
        </table>
    </div>
</div>
