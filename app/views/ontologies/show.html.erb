<%@title = "#{@ontology.displayLabel}"%>

<script src="/javascripts/jquery.rating.pack.js" type="text/javascript" charset="utf-8"></script>
<link rel="stylesheet" href="/stylesheets/layout/jquery.rating.css" type="text/css" media="screen" title="no title" charset="utf-8">
<script src="/javascripts/JqueryPlugins/tagcloud/jquery.tagcloud.min.js" type="text/javascript" charset="utf-8"></script>
<script src="/javascripts/JqueryPlugins/tagcloud/jquery.tinysort.min.js" type="text/javascript" charset="utf-8"></script>


<script type="text/javascript">
	function meta_tab_clicked(content,tab){
		jQuery(".tab_content").hide();
		jQuery(content).show();
		jQuery(".tab").removeClass("selected");
		jQuery(tab).parent().addClass("selected");
		return false;
		
	}
	
	jQuery(document).ready(function()  {
		<%if @notes.size>0%>
		jQuery("#notes").tagcloud({type:"list",sizemin:10,colormin:"#3C46FF",colormax:"#3C46FF",sizemax:14})
		<%end%>
		<%if @mappings.size >0%>
		jQuery("#mappings").tagcloud({type:"list",sizemin:10,colormin:"#3C46FF",colormax:"#3C46FF",sizemax:14})
		<%end%>

		//Auto loads the correct tab
	    loc = new String(document.location)
	    if(loc.search("#")>=0){
	        jQuery("#metadata_content").hide();
	        id = "#" + loc.split("#")[1]
			// The actual content to hide/show is in id_content
			id_content = id + "_content";
	        jQuery(id_content).show();
	        jQuery(".tab").removeClass("selected");
	        jQuery(id+"_top").addClass("selected")
	        tab_li = jQuery(jQuery("a[href='"+id+"']").parents().get(0))
	        tab_li.addClass("selected");
	        a = jQuery("a[href='"+id+":']")
	        eval(a.attr("alt"));
	    }

	});
	
	
	var searchbox;

function jumpToValue(li){
	if( li == null ){
	// Im doing a search	
	
	var search = confirm("Concept could not be found..\n Press OK to go to the Search page or Cancel to continue browsing")
		if(search){
			jQuery("#search_keyword").val(jQuery("#search_box").val())
			jQuery("#search_form").submit()
			return
		}
	}

		// if coming from an AJAX call, let's use the CityId as the value
		if( !!li.extra ){
			
			var sValue = li.extra[0];
			
			document.location="/visualize/<%=@ontology.id%>/"+sValue;
			jQuery.blockUI({ message: '<h1><img src="/images/tree/spinner.gif" /> Loading Concept...</h1>' }); 
			return
		}

	
}

function formatItem(row) {
 	return row[0] + " <span style='font-size:9px;color:blue;' >(" + row[2] + ")</span>";
}

<%if !@ontology.isRemote.to_i.eql?(1)%>

$(document).ready(function(){
	 $("#search_box").autocomplete("/search/json_search/<%=@ontology.ontologyId%>", { lineSeparator:"~!~",matchSubset:0,minChars:3,maxItemsToShow:20,onFindValue:jumpToValue,formatItem:formatItem });
	searchbox =  $("#search_box")[0].autocompleter;
	
});
<%end%>


	

</script>


<div style="padding:5px;">
<%if flash[:notice]%>
<div style="padding:5px;border:1px solid gray;font-size:14px; background-color:#ffffcc;">
<p><%=flash[:notice]%></p>
</div>
<%end%>

<h1><%=@ontology.displayLabel%> &nbsp;&nbsp;&nbsp;&nbsp;<a href="/syndication/rss?ontologies=<%=@ontology.ontologyId%>" style="text-decoration:none;font-size:14px;"><img src="/images/feed-icon.png" height=16 width=16 border=0 > Subscribe to updates</a></h1> 
<%if !session[:user].nil? && (session[:user].id.to_i.eql?(@ontology.userId.to_i) || session[:user].admin?)%>
<table class="form">
	<tr>
			<td class="top"><%=link_to "Submit New Version",new_ontology_path(:id=>@ontology.ontologyId)%></td>
			<td class="top"><%=link_to "Edit Ontology Information",edit_ontology_path(:id=>@ontology.id)%></td>
	</tr>
</table>
<%end%>

<div class="tabs" style="margin-top:5px;margin-bottom:10px;border-top:1px solid #CFCFCF;">
	<ul >
		<li id="#metadata" class="selected tab"><a href="#metadata" onclick="meta_tab_clicked('#metadata_content',this)">Metadata</a></li>
		<li id="#views" class="tab"><a href="#views" onclick="meta_tab_clicked('#views_content',this)">Views (<%=@ontology.views.size%>)</a></li>
		<li id="#projects" class="tab"><a href="#projects" onclick="meta_tab_clicked('#projects_content',this)">Projects (<%=@projects.size%>)</a></li>
    	<li id="#reviews" class="tab"><a href="#reviews" onclick="meta_tab_clicked('#reviews_content',this)">Reviews (<%=@reviews.size%>)</a></li>
		<li id="#widgets" class="tab"><a href="#widgets" onclick="meta_tab_clicked('#widgets_content',this)">Ontology Widgets</a></li>		
	</ul>  
</div>

<div id="metadata_content" class="tab_content" >
<div style="width:100%;min-width:900px">
<div style="float:left;width:60%;overflow:hidden;min-width:550px">
<br/>
<table class="form" width="100%">
	<tr>
			<th>Ontology Name:</th><td class="top"><%=@ontology.displayLabel%></td>
	</tr>
	<tr>
			<th>Ontology Id:</th><td><%=@ontology.ontologyId%></td> 
			
	</tr>
	<tr>
			<th>Format:</th><td><%if @ontology.format.eql?("OBO")%><%=@ontology.format+"F"%><%else%><%=@ontology.format.split("-")[0]%><%end%></td>
	</tr>
	<tr>
			<th>Categories:</th><td><%for cat in @ontology.categories%><%=@categories[cat.to_s][:name]%><br/> <%end%></td> 
	</tr>
	<tr>
			<th>Contact:</th><td><%=@ontology.contactName%>, <%=@ontology.contactEmail%></td>
	</tr>
	<tr>
		<th>Home Page:</th><td><a href="<%=@ontology.homepage%>" target="_blank"><%=@ontology.homepage%></a></td>
	</tr>
	<tr>
		<th>Publications Page:</th><td><a href="<%=@ontology.publication%>" target="_blank"><%=@ontology.publication%></a></td>
	</tr>
	<tr>
		<th> Documentation Page:</th><td><a href="<%=@ontology.documentation%>" target="_blank"><%=@ontology.documentation%></a></td>
	</tr>
	<tr>
		<th >Description:</th><td><%=@ontology.description%></td>
	</tr>
</table>

<br/>
<br/>
	<table class="zebra" cellpadding="0" cellspacing="0" width="100%">
		<thead>
		<tr>
			<th>Version Number</th>
			<th>Release Date</th>
			<th>Ontology File</th>
			<th>Visualize</th>
			<th>Download Diff File</th>			
		</tr>
		</thead>
		
		<%
		@versions.sort!{|x,y| y.internalVersion.to_i<=>x.internalVersion.to_i}

		for version in @versions%>
		
		<tr <%=cycle("","class='alt'")%>>
			<td><%=version.versionNumber%></td>
			<td><%=version.dateReleased%></td>			
			<td><% if version.isRemote.to_i.eql?(1)%><a href="<%=@ontology.homepage%>"><%else%><a href="<%=DataAccess.download(version.id)%>" target="_blank">Download Ontology</a><%end%></td>
			<td>
			  <%= version.get_visualize_link %>
			</td>
			<td >
				<% for diff in @diffs%>
					<%if diff[1].to_i.eql?(version.id.to_i)%>
						Download Diff with previous version <br/>( <a href="<%=$REST_URL%>/diffs/download/<%=diff[0]%>/<%=diff[1]%>?format=txt">Txt</a> | <a href="<%=$REST_URL%>/diffs/download/<%=diff[0]%>/<%=diff[1]%>?format=rdf">RDF</a> )
					<%end%>
				<%end%>
				&nbsp;
			</td>
		</tr>
		<%end%>
	</table>
	
</div>
<br/>
	<div style="float:left;width:300px;padding-left:10px;" id="tag_clouds">
		<h2>Notes</h2>
		<%if @notes.size <1%>
		No Notes Created yet
		<%end%>
		<ul id="notes" style="border-top:1px solid #C1DAD7;border-bottom:1px solid #C1DAD7;width:300px;padding:10px">
		<%for note in @notes%>
			<li value="<%=note[1]%>"><a href="/visualize/<%=@ontology.id%>/<%=note[0]%>#t_tab3:"><%=note[0]%></a></li>
		<%end%>
		</ul>
		<br/>
		<h2>Mappings</h2>
		<%if @mappings.size <1%>
		No Mappings Created yet
		<%end%>
		<ul id="mappings" style="border-top:1px solid #C1DAD7;border-bottom:1px solid #C1DAD7;width:300px;padding:10px">
		<%for mapping in @mappings%>
			<li value="<%=mapping[1]%>"><a href="/visualize/<%=@ontology.id%>/<%=mapping[0]%>#t_tab4:"><%=mapping[2]%></a></li>
		<%end%>
		</ul>
	</div>

<div style="clear:both;"></div>
</div>
</div>

<div id="projects_content" style="display:none;" class="tab_content">

	<br>
	<table class="zebra" style="border:0px;float:left;"width="60%" cellpadding="0" cellspacing="0">

		<%for project in @projects%>
		<tr>
			<td colspan="2" class="pheader"><%=link_to project.name, project,:style=>"text-decoration:none;"%> <%if isOwner?(project.id)%><%=link_to "Edit Project",edit_project_path(project)%> <%= link_to 'Delete Project', project, :confirm => 'Are you sure?', :method => :delete %><%end%></td>
		</tr>
		<tr style="background-color:#EFEFEF">
			<td  colspan="2" style="padding:10px;border-bottom:1px solid #9F9F9F"><%=project.description%></td>
		</tr>
		<tr>
			<th style="width:100px;text-align:left;padding:5px;">People:</th><td align="left"style="padding-top:5px;width:100%;"><%=project.people%></td>
		</tr>
		<tr>
			<th style="width:100px;text-align:left;padding:5px;">Institution:</th><td align="left"style="padding-top:5px;width:100%;"><%=project.institution%></td>
		</tr>
		<tr>
			<th style="width:100px;text-align:left;padding:5px;">Homepage:</th><td align="left"style="padding-top:5px;width:100%;"><%=link_to project.homepage, project.homepage%></td>
		</tr>

		<tr>
			<td colspan="2" style="width:100%;margin-bottom:15px;"><hr/></td>
		</tr>
		<%end%>
	</table>
</div>

<div id="reviews_content" style="display:none;" class="tab_content">
<%if session[:user].nil? %>
	<br>
		<a href="/login?redirect=/ontologies/<%=@ontology.id%>">Review This Ontology</a>
<%else%>
<h2><a href="/reviews/new?ontology=<%=@ontology.ontologyId%>&height=500&width=600" title="Review For <%=@ontology.displayLabel%>" class="thickbox">Review This Ontology</a></h2>
<%end%>
	<br>
	<table class="zebra" cellpadding="0" cellspacing="0" width="60%">
	
	<% for review in @reviews %>

		<thead>
		<tr>

			<th>Review By <%=review.user.username%> <%unless review.project.nil?%> From Project <%=link_to review.project.name,project_path(review.project)%><%end%><%if isOwner?(review.user_id)%> <%=link_to "Edit Review",edit_review_path(review)%> <%end%></th>
		</tr>
		</thead>

		<tr>
				<td><div class="star_ratings">
				<%for rating in review.ratings%>				
				<li>
						<%if rating.value.eql?(0)%>
						<span style="float:left;">Not Rated</span>
						<%else%>
						<input name="star_<%=rating.id%>" type="radio" class="star" value="1" <% if rating.value.to_i.eql?(1)%> checked="checked" <%end%> disabled="disabled" /> 
						<input name="star_<%=rating.id%>" type="radio" class="star" value="2" <% if rating.value.to_i.eql?(2)%> checked="checked" <%end%>disabled="disabled" /> 
						<input name="star_<%=rating.id%>" type="radio" class="star" value="3" <% if rating.value.to_i.eql?(3)%> checked="checked" <%end%>disabled="disabled" /> 
						<input name="star_<%=rating.id%>" type="radio" class="star" value="4" <% if rating.value.to_i.eql?(4)%> checked="checked" <%end%>disabled="disabled" /> 
						<input name="star_<%=rating.id%>" type="radio" class="star" value="5" <% if rating.value.to_i.eql?(5)%> checked="checked" <%end%>disabled="disabled" />


						<%end%>
					<b>&nbsp;<%=rating.rating_type.name%></b>
				</li>

				<%end%>
				</div>
				<p><%=review.review%></p>

			</td>
		</tr>
		<tr>
			<td id="<%=@ontology.ontologyId%>_review">&nbsp;</td>
		</tr>
	<% end %>
</table>
</div>

<%if !@ontology.isRemote.to_i.eql?(1)%>
<div id="widgets_content" style="display:none;" class="tab_content">

<div style="float:left;">
<h1>Adding a NCBO Widgets for <%=@ontology.displayLabel%> To Your Site</h1>
<h2>Step1 Select a widget:</h2><hr/>

	<center>

<style>
#widget_table td{
	border:1px solid #EFEFEF;
	padding:10px;
}
#widget_table th{
	font-size:15px;
	font-weight:bold;
	background-color:#f5fafa;
	padding:5px;
}
.getcode{
font-weight:bold;
font-size:15px;
		background-color:#f5fafa;
		border:1px solid #AAAAAA;
		padding:3px 10px 3px 10px;

		text-decoration:none;
}

</style>

<table width="80%" id="widget_table">
	
	<tr>
		<th>Widget Description</th>
		<th style="border-left:1px solid #EFEFEF;">Widget Demonstration</th>
	</tr>
	
	<tr>
		<td><h3>Type a term in <%=@ontology.displayLabel%> ontology and jump to it in BioPortal</h3><br/><a href="#TB_inline?height=400&width=600&inlineId=jump" class="thickbox getcode" >Get Code</a></td>
		<td>
			
		Jump To: <input type="textbox" id="search_box" size="30"/> <input type="button" value="Go" onclick="searchbox.findValue()"/>
		

		<div id="jump" style="display:none;">
			<h2>Step2 Follow the Instructions:</h2><hr/>
		<ul>
			<li>- Download the <a rel="nofollow" title="http://bioportal.bioontology.org/javascripts/widgets/quick_jump.js" class="external free" href="http://bioportal.bioontology.org/javascripts/widgets/quick_jump.js"><b>quick_jump.js file</b></a>  and put it on your server</li>
			<li>- Copy the code below and paste it to your HTML page</li>
			<li>- In the code that you just pasted, make sure to change the path to the quick_jump.js file to point to the location where you put the file (relative to your HTML file)
				<ul>
					<li>&nbsp;&nbsp;- For example, if you put the quick_jump.js file in the same directory as your HTML file, you will have:</li>
				</ul>
			</li>
		</ul>
			<textarea rows=4 cols=70>
			<script type="text/javascript">
			var BP_ontology_id = "<%=@ontology.ontologyId%>"
			</script>
			<script src="quick_jump.js" type="text/javascript" charset="utf-8"></script>
			</textarea>

			</ul>
			
		
<p>For more help visit <a href="http://bioontology.org/wiki/index.php/NCBO_Widgets#How_to_use_NCBO_Widgets">NCBO Widget Wiki</a></p>
			
		</div>
		</td>
	</tr>
	

	
	<tr >
			<td ><h3>Fill in a field in your form with a term from <%=@ontology.displayLabel%> ontology</h3><br/><a href="#TB_inline?height=400&width=600&inlineId=form" class="thickbox getcode" >Get Code</a>
			</td>
			<td>
			<script src="/javascripts/widgets/form_complete.js" type="text/javascript" charset="utf-8"></script>

				
			Example 1 (start typing the term name to get its full URI)<br/><input type="text" name="a" class="bp_form_complete-<%=@ontology.ontologyId%>-uri" size="100"/><br/>
			Example 2 (get the ID for a concept)<br/><input type="text" name="b" class="bp_form_complete-<%=@ontology.ontologyId%>-shortid" size="100"/><br/>
			Example 3 (get the preferred name for a concept)<br/><input type="text" name="c" class="bp_form_complete-<%=@ontology.ontologyId%>-name" size="100"/><br/>
			
			<div id="form" style="display:none;">

			<h2>Step2 Follow the Instructions:</h2><hr/>
			<ul><li> Download the <a rel="nofollow" title="http://bioportal.bioontology.org/javascripts/widgets/form_complete.js" class="external free" href="http://bioportal.bioontology.org/javascripts/widgets/form_complete.js"> <b>form_complete.js file</b></a>  and put it on your server
</li>
<li>- In the header for the page where you want the form field, include the <b>form_complete.js</b> file</li>
<li>- On your form, for the fields where you want to use the term-selection widget, specify the class in the following format: <code>bp_form_complete-{ontology_id}-{value}</code>
	<ul>
	<li>&nbsp;&nbsp;- For example, <code>bp_form_complete-1032-uri</code> will use NCI Thesaurus (ontology id is 1032) and will put the term URI in the field after the user selects the term from the pull-down list.</li>
	<li>&nbsp;&nbsp;- You can use the following values:
		<ul><li>&nbsp;&nbsp;&nbsp;- <code>uri</code>: put the complete URI of the concept (e.g., <a rel="nofollow" title="http://bioportal.bioontology.org/visualize/39478/Common_Neoplasm" class="external free" href="http://bioportal.bioontology.org/visualize/39478/Common_Neoplasm">http://bioportal.bioontology.org/visualize/39478/Common_Neoplasm</a>);</li>
			<li>&nbsp;&nbsp;&nbsp;- <code>shortid</code>: put the short id of the concept, as used in BioPortal (e.g., "Common_Neoplasm");</li>
			<li>&nbsp;&nbsp;&nbsp;- <code>name</code>: put the preferred name of the concept (e.g., "Common Neoplasm");</li>
		</ul>
	</li>
	</ul>
</li>
</ul>
<p>
<b>Examples:</b><br/>
			<textarea rows=4 cols=70>
Example 1 (start typing the term name to get its full URI)<br/><input type="text" name="a" class="bp_form_complete-<%=@ontology.ontologyId%>-uri" size="100"/>

Example 2 (get the ID for a concept)<br/><input type="text" name="b" class="bp_form_complete-<%=@ontology.ontologyId%>-shortid" size="100"/>

Example 3 (get the preferred name for a concept)<br/><input type="text" name="c" class="bp_form_complete-<%=@ontology.ontologyId%>-name" size="100"/>
		
			</textarea>
</p>	
 <p>For more help visit <a href="http://bioontology.org/wiki/index.php/NCBO_Widgets#How_to_use_NCBO_Widgets">NCBO Widget Wiki</a></p>
				
			</div>
			</td>
	</tr>
		
		<tr >
			<td ><h3>Get RSS feed for changes in <%=@ontology.displayLabel%> ontology</h3><br/><a href="#TB_inline?height=400&width=600&inlineId=feed" class="thickbox getcode" >Get Code</a>
			</td>
			<td>
			<script type="text/javascript">
			var BP_ontology_id = "<%=@ontology.ontologyId%>"
			</script>
			<script src="/javascripts/widgets/feed_widget.js" type="text/javascript" charset="utf-8"></script>
			<div id="feed" style="display:none;">
			<h2>Step2 Follow the Instructions:</h2><hr/>

					<b>Copy the code below and paste it to your HTML page</b><br/><br/>
			<textarea rows=4 cols=70>
	<script type="text/javascript">
	var BP_ontology_id = "<%=@ontology.ontologyId%>"
	</script>
	<script src="http://bioportal.bioontology.org/javascripts/widgets/feed_widget.js" type="text/javascript" charset="utf-8"></script>
			</textarea>
			
			<br/>
			<h2>Referencing an ontology in your widgets</h2>
	
 			<br/>
<p>For more help visit <a href="http://bioontology.org/wiki/index.php/NCBO_Widgets#How_to_use_NCBO_Widgets">NCBO Widget Wiki</a></p>

			
			</div>
			</td>
	</tr>
	
		<tr>
			<td><h3>Visualize <%=@ontology.displayLabel%> ontology</h3><br/><a href="#TB_inline?height=400&width=600&inlineId=visual" class="thickbox getcode" >Get Code</a>
			</td>
			<td>
			
				<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
						id="FlexoViz" width="300px" height="300px"
						codebase="http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab">
						<param name="movie" value="http://keg.cs.uvic.ca/ncbo/flexviz/FlexoViz.swf?v=<%=$FLEX_VERSION%>" />
						<param name="quality" value="high" />
						<param name="bgcolor" value="#ffffff" />
						<param name="allowScriptAccess" value="always" />
						<embed src="http://keg.cs.uvic.ca/ncbo/flexviz/FlexoViz.swf?v=<%=$FLEX_VERSION%>" bgcolor="#ffffff"
							width="100%" height="100%" name="FlexoViz" align="middle"
							play="true"
							loop="false"
							quality="high"
							allowScriptAccess="always"
							type="application/x-shockwave-flash"
							flashVars="widget=true&ontology=<%=@ontology.id%>&server=http://rest.bioontology.org/bioportal/"
							pluginspage="http://www.adobe.com/go/getflashplayer">
						</embed>
				</object>
				<div id ="visual" style="display:none"
			<h2>Step2 Follow the Instructions:</h2><hr/>
					<b>Copy the code below and paste it to your HTML page</b><br/><br/>
			<textarea rows=4 cols=70>
				<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
						id="FlexoViz" width="100%" height="100%"
						codebase="http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab">
						<param name="movie" value="http://keg.cs.uvic.ca/ncbo/flexviz/FlexoViz.swf?v=<%=$FLEX_VERSION%>" />
						<param name="quality" value="high" />
						<param name="bgcolor" value="#ffffff" />
						<param name="allowScriptAccess" value="always" />
						<embed src="http://keg.cs.uvic.ca/ncbo/flexviz/FlexoViz.swf?v=<%=$FLEX_VERSION%>" bgcolor="#ffffff"
							width="100%" height="100%" name="FlexoViz" align="middle"
							play="true"
							loop="false"
							quality="high"
							allowScriptAccess="always"
							type="application/x-shockwave-flash"
							flashVars="widget=true&ontology=<%=@ontology.id%>&server=http://rest.bioontology.org/bioportal/"
							pluginspage="http://www.adobe.com/go/getflashplayer">
						</embed>
				</object>
			</textarea>
			<br/>
<p>		
		If you want the visualization to be focused on a particular term in the ontology, you can add the term id to the parameters above. For example, to have the widget focus on Melanoma in NCI Thesaurus, replace the following line in the snippet above:
		<br/>
		<b>flashVars="widget=true&ontology=39478&server=http://rest.bioontology.org/bioportal/"</b>
		<br/>
		with
		<br/>
		<b>flashVars="widget=true&ontology=39478&nodeid=Melanoma&server=http://rest.bioontology.org/bioportal/"</b>
</p>
		
<p>For more help visit <a href="http://bioontology.org/wiki/index.php/NCBO_Widgets#How_to_use_NCBO_Widgets">NCBO Widget Wiki</a></p>


			</div>
			</td>
		</tr>	
	
</table>


</center>
</div>
<div style="clear:both;"></div>
</div>
<%end%>
<div id="views_content" style="display:none;" class="tab_content">
	<div style="float:left;width:1000px;" >

		<%if session[:user].nil? %>
<h3><a href="/login">Create New View</a></h3>		
		<%else%>
<h3><a href="/ontologies/new_view/new?version_id=<%=@ontology.id%>">Create New View</a></h3>		
		<%end%>
<%if @ontology.views.empty? || @ontology.views.first.size < 1%>
<h1> No views available.</h1>
<%else%>

<%for virtual in @ontology.views%>

<%if virtual[0].nil?
	next
end%>
<table class="form" width="100%">
	<tr>
			<th>View Name:</th><td class="top"><%=virtual[0].displayLabel%></td> <th>Created By:</th><td class="top"><%=virtual[0].contactName%></td>
	</tr>
	<tr>
		<th>View Id:</th><td><%=virtual[0].ontologyId%></td>
		<th>View Generation Engine:</th><td><%=virtual[0].viewGenerationEngine%></td>
	</tr>
	<tr>
		<th>View Definition:</th><td><%=virtual[0].viewDefinition%></td>
		<th>View Definition Language:</th><td><%=virtual[0].viewDefinitionLanguage%></td>
	<tr>
		<th >Description:</th><td colspan=3><%=virtual[0].description%></td>
	</tr>

</table>
<h3 style="border-bottom:1px solid #EFEFEF;margin-left:20px;">Versions</h3>
	<table class="zebra" cellpadding="0" cellspacing="0" width="100%" style="margin-left:40px;">
		<thead>
		<tr>
			<th>Version</th>
			<th>Base Version</th>
			<th>Created</th>
			<th>Ontology File</th>
			<th>Visualize</th>
		</tr>
		</thead>
		
<%
virtual.sort!{|x,y| y.internalVersion<=>x.internalVersion}
for view in virtual%>

		
		<tr >
			<td><%=view.versionNumber%></td>
			<td><%=@ontology.versionNumber%></td>
			<td><%=view.dateReleased%></td>			
			<td><a href="<%=DataAccess.download(view.id)%>" target="_blank">Download View</a></td>
			<td><%if view.statusId.to_i.eql?(3)%><%=link_to "Explore", visualize_url(:ontology => view,:view=>true)%><%else%>Parsing View<%end%></td>

		</tr>

<%end%>
	</table>
<%if !session[:user].nil? && (session[:user].id.to_i.eql?(view.userId.to_i) || session[:user].admin?)%>
		<h3 style="margin-left:40px;"><a href="/ontologies/new_view/<%=view.id%>?version_id=<%=@ontology.id%>">Submit New View Version</a></h3>
<%end%>
<br/>
<%end%>
<%end%>
</div>
</div>

	

