class OntologyRanker

  WEIGHT = { 1032 => 1000, 1353 => 999, 1123 => 998, 1009 => 997, 1057 => 996, 1136 => 995, 1351 => 994, 1053 => 993, 1132 => 992, 1084 => 991, 1069 => 990, 1070 => 989, 1498 => 988, 1498 => 987, 1498 => 986, 1007 => 985, 1101 => 984, 1125 => 983, 1006 => 982, 1245 => 981, 1108 => 980, 1083 => 979, 1332 => 978, 1000 => 977, 1107 => 976, 1350 => 975, 1290 => 974, 1352 => 973, 1076 => 972, 1005 => 971, 1104 => 970, 1506 => 969, 1423 => 968, 1587 => 967, 1348 => 966, 1112 => 965, 1038 => 964, 1038 => 963, 1051 => 962, 1533 => 961, 1035 => 960, 1092 => 959, 1041 => 958, 1012 => 957, 1016 => 956, 1422 => 955, 1109 => 954, 1106 => 953, 1397 => 952, 1149 => 951, 1321 => 950, 1054 => 949, 1068 => 948, 1404 => 947, 1507 => 946, 1314 => 945, 1427 => 944, 1040 => 943, 1541 => 942, 1062 => 941, 1090 => 940, 1031 => 939, 1025 => 938, 1085 => 937, 1105 => 936, 1131 => 935, 1082 => 934, 1015 => 933, 1344 => 932, 1001 => 931, 1699 => 930, 1158 => 929, 1341 => 928, 1108 => 927, 1099 => 926, 1343 => 925, 1019 => 924, 1516 => 923, 1089 => 922, 1414 => 921, 1354 => 920, 1046 => 919, 1413 => 918, 1393 => 917, 1042 => 916, 1349 => 915, 1110 => 914, 1033 => 913, 1013 => 912, 1424 => 911, 1152 => 910, 1311 => 909, 1172 => 908, 1036 => 907, 1415 => 906, 1049 => 905, 1504 => 904, 1058 => 903, 1010 => 902, 1047 => 901, 1001 => 900, 1510 => 899, 1429 => 898, 1067 => 897, 1059 => 896, 1401 => 895, 1050 => 894, 1037 => 893, 1553 => 892, 1038 => 891, 1148 => 890, 1078 => 889, 1141 => 888, 1489 => 887, 1091 => 886, 1568 => 885, 1087 => 884, 1142 => 883, 1023 => 882, 1114 => 881, 1633 => 880, 1560 => 879, 1639 => 878, 1532 => 877, 1425 => 876, 1613 => 875, 1487 => 874, 1370 => 873, 1134 => 872, 1126 => 871, 1021 => 870, 1011 => 869, 1095 => 868, 1150 => 867, 1347 => 866, 1586 => 865, 1621 => 864, 1419 => 863, 1190 => 862, 1048 => 861, 1526 => 860, 1527 => 859, 1081 => 858, 1043 => 857, 1489 => 856, 1061 => 855, 1056 => 854, 1304 => 853, 1130 => 852, 1100 => 851, 1039 => 850, 1222 => 849, 1026 => 848, 1438 => 847, 1411 => 846, 1044 => 845, 1381 => 844, 1402 => 843, 1529 => 842, 1146 => 841, 3020 => 840, 3008 => 839, 1426 => 838, 1505 => 837, 1576 => 836, 1632 => 835, 1581 => 834, 1580 => 833, 1362 => 832, 1115 => 831, 1658 => 830, 1430 => 829, 1064 => 828, 1444 => 827, 1001 => 826, 1077 => 825, 1497 => 824, 1094 => 823, 1063 => 822, 3016 => 821, 1696 => 820, 1060 => 819, 1183 => 818, 1237 => 817, 1122 => 816, 1128 => 815, 1585 => 814, 1030 => 813, 1065 => 812, 1522 => 811, 1578 => 810, 1398 => 809, 1528 => 808, 1052 => 807, 1574 => 806, 1650 => 805, 1521 => 804, 1640 => 803, 1539 => 802, 3003 => 801, 1440 => 800, 1116 => 799, 1055 => 798, 1192 => 797, 1022 => 796, 1088 => 795, 1086 => 794, 1027 => 793, 1029 => 792, 1135 => 791, 1144 => 790, 1017 => 789, 1024 => 788, 1328 => 787, 1008 => 786, 1461 => 785, 1247 => 784, 1407 => 783, 1583 => 782, 1550 => 781, 1565 => 780, 1530 => 779, 1631 => 778, 1569 => 777, 1509 => 776, 1501 => 775, 1409 => 774, 1494 => 773, 1570 => 772, 1571 => 771, 1537 => 770, 1651 => 769, 3030 => 768, 1638 => 767, 3108 => 766, 1517 => 765, 1410 => 764, 1417 => 763, 1484 => 762, 1672 => 761, 1394 => 760, 1582 => 759, 1524 => 758, 1523 => 757, 1540 => 756, 1335 => 755, 1369 => 754, 1399 => 753, 1538 => 752, 1249 => 751, 3114 => 750, 1588 => 749, 1500 => 748, 1257 => 747, 3042 => 746, 3002 => 745, 1575 => 744, 1418 => 743, 1671 => 742, 3013 => 741, 1686 => 740, 3015 => 739, 3022 => 738, 3029 => 737, 3028 => 736, 1689 => 735, 1616 => 734, 1666 => 733, 1515 => 732, 1439 => 731, 1572 => 730, 1406 => 729, 1567 => 728, 1552 => 727, 1665 => 726, 1615 => 725, 1573 => 724, 1488 => 723, 1584 => 722, 1545 => 721, 1491 => 720, 1614 => 719, 1490 => 718, 1659 => 717, 3006 => 716, 3004 => 715, 3078 => 714, 1534 => 713, 3059 => 712, 3025 => 711, 3000 => 710, 3012 => 709, 1676 => 708, 3090 => 707, 3091 => 706, 3048 => 705, 3126 => 704, 3049 => 703, 1537 => 702, 3124 => 701, 3119 => 700, 1625 => 699, 3034 => 698, 3046 => 697, 3035 => 696, 3037 => 695, 1520 => 694, 3137 => 693, 3019 => 692, 3062 => 691, 1625 => 690, 1626 => 689, 1627 => 688, 3064 => 687, 1675 => 686, 3105 => 685, 3024 => 684, 3094 => 683, 3087 => 682, 1660 => 681, 3065 => 680, 3084 => 679, 3018 => 678, 3080 => 677, 1694 => 676, 3061 => 675, 3092 => 674, 1667 => 673, 3021 => 672, 1702 => 671, 3017 => 670, 1596 => 669, 1648 => 668, 1698 => 667, 3047 => 666, 1642 => 665, 1654 => 664, 1630 => 663, 3001 => 662, 1693 => 661, 1647 => 660, 1643 => 659, 3045 => 658, 1641 => 657, 3007 => 656, 3043 => 655, 3104 => 654, 1697 => 653, 3089 => 652, 1701 => 651, 1649 => 650, 1652 => 649, 1668 => 648, 1653 => 647, 3038 => 646, 3044 => 645, 1661 => 644, 1629 => 643, 3032 => 642, 1670 => 641, 3081 => 640, 3050 => 639, 3014 => 638, 1691 => 637, 3120 => 636, 3125 => 635, 3129 => 634, 3131 => 633, 3134 => 632, 3135 => 631, 3136 => 630, 3143 => 629, 3146 => 628, 3153 => 627, 3154 => 626, 3155 => 625, 3156 => 624, 3157 => 623, 3158 => 622, 3163 => 621, 3164 => 620, 3167 => 619, 3169 => 618, 3031 => 617, 3077 => 616, 1682 => 615, 3127 => 614, 3150 => 613, 3151 => 612, 3152 => 611, 3162 => 610, 3147 => 609, 1555 => 608, 3139 => 607, 1014 => 606, 1224 => 605, 3159 => 604, 1684 => 603, 3066 => 602, 3100 => 601, 3086 => 600, 3095 => 599, 3060 => 598, 3088 => 597, 1683 => 596, 1680 => 595, 1681 => 594, 1679 => 593, 3098 => 592, 3099 => 591, 3101 => 590, 3103 => 589, 3107 => 588, 3111 => 587, 3112 => 586, 3113 => 585, 3096 => 584, 3097 => 583, 1688 => 582, 3115 => 581, 3116 => 580, 3117 => 579, 3118 => 578, 3132 => 577, 3133 => 576, 3138 => 575, 3140 => 574, 3141 => 573, 3142 => 572, 3144 => 571, 3148 => 570, 3149 => 569, 3161 => 568, 3165 => 567, 3166 => 566 }

  ##
  # Takes an array of integers, arrays, or hashes. If using array or hash, must provide location of ontology virtual id.
  # Options:
  # :position => location in the array (int) or hash key containing the virtual id
  def self.rank(ont_ary, options = {})
    return nil if !ont_ary.kind_of?(Array)
    position = options[:position]

    ranked = []
    not_ranked = []
    ont_ary.each do |ont|
      if position.nil?
        if WEIGHT.key?(ont.to_i)
          ranked << ont
        else
          not_ranked << ont
        end
      else
        if WEIGHT.key?(ont[position].to_i)
          ranked << ont
        else
          not_ranked << ont
        end
      end
    end

    # Sort ontologies
    if position.nil?
      ranked.sort! {|a,b| WEIGHT[b.to_i] <=> WEIGHT[a.to_i]}
    else
      # Get a ranked list of the virtual ids in the ranked set
      ranked.sort! {|a,b| WEIGHT[b[position].to_i] <=> WEIGHT[a[position].to_i]}
    end

    # Recombine the ranked and non-ranked
    ranked.concat not_ranked
  end

  def self.rank!(ont_ary, options = {})
    ont_ary = self.rank(ont_ary, options)
  end

end